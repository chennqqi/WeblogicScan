#!/usr/bin/env python
# _*_ coding:utf-8 _*_


import sys
import requests

from ..platform import ManageProcessor

VUL = 'CVE-2014-4210'

@ManageProcessor.plugin_register('SSRF')
class SSRF(object):
    def process(self,ip,port):
        self.run(ip,port)

    def islive(self,ur,port):
        url='http://' + str(ur)+':'+str(port)+'/uddiexplorer/'
        r = requests.get(url, self.headers)
        return r.status_code

    def run(self,url,port):
        if self.islive(url,port)==200:
            u='http://' + str(url)+':'+str(port)+'/uddiexplorer/'
            return CVE_RESULT(VUL, u)
        else:
            return None
