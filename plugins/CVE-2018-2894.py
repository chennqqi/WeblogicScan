#!/usr/bin/env python
# _*_ coding:utf-8 _*_

import requests
import re


from ..platform import ManageProcessor


VUL='CVE-2018-2894'

@ManageProcessor.plugin_register('CVE20182894')
class CVE20182894(object):
    def process(self,ip,port):
        self.run(ip,port,0)

    def islive(self,ur,port):
        self.url='http://' + str(ur)+':'+str(port)+'/ws_utc/resources/setting/options/general'
        r = requests.get(url, self.headers)
        return r.status_code

    def run(self,url,port,index):
        if self.islive(url,port)!= 404:
            return CVE_RESULT(VUL,self.url)
        else:
            return Non
